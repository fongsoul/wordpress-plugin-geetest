"use strict";var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof module?"undefined":y(module))&&"object"===y(module.exports)?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("Geetest requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:void 0,function(c,e){if(void 0===c)throw new Error("Geetest requires browser environment");var s=c.document,a=c.Math,u=s.getElementsByTagName("head")[0];function i(e){this._obj=e}function t(e){var n=this;new i(e)._each(function(e,t){n[e]=t})}i.prototype={_each:function(e){var t=this._obj;for(var n in t)t.hasOwnProperty(n)&&e(n,t[n]);return this}},t.prototype={api_server:"api.geetest.com",protocol:"http://",type_path:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var e=this;return l(e.type)?e.fallback_config[e.type]:e.new_captcha?e.fallback_config.fullpage:e.fallback_config.slide},_extend:function(e){var n=this;new i(e)._each(function(e,t){n[e]=t})}};function f(e,t,n,o){t=function(e){return e.replace(/^https?:\/\/|\/$/g,"")}(t);var r=function(e){return 0!==(e=e.replace(/\/+/g,"/")).indexOf("/")&&(e="/"+e),e}(n)+function(e){if(!e)return"";var n="?";return new i(e)._each(function(e,t){(l(t)||function(e){return"number"==typeof e}(t)||function(e){return"boolean"==typeof e}(t))&&(n=n+encodeURIComponent(e)+"="+encodeURIComponent(t)+"&")}),"?"===n&&(n=""),n.replace(/&$/,"")}(o);return t&&(r=e+t+r),r}function p(e,o,r,a,i){!function t(n){!function(e,t){var n=s.createElement("script");n.charset="UTF-8",n.async=!0;var o=!(n.onerror=function(){t(!0)});n.onload=n.onreadystatechange=function(){o||n.readyState&&"loaded"!==n.readyState&&"complete"!==n.readyState||(o=!0,setTimeout(function(){t(!1)},0))},n.src=e,u.appendChild(n)}(f(e,o[n],r,a),function(e){e?n>=o.length-1?i(!0):t(n+1):i(!1)})}(0)}function n(e,t,n,o){if(function(e){return"object"===(void 0===e?"undefined":y(e))&&null!==e}(n.getLib))return n._extend(n.getLib),void o(n);if(n.offline)o(n._get_fallback_config());else{var r="geetest_"+(parseInt(1e4*a.random())+(new Date).valueOf());c[r]=function(e){"success"===e.status?o(e.data):e.status?o(n._get_fallback_config()):o(e),c[r]=void 0;try{delete c[r]}catch(e){}},p(n.protocol,e,t,{gt:n.gt,callback:r},function(e){e&&o(n._get_fallback_config())})}}function d(e,t){var n={networkError:"网络错误"};"function"==typeof t.onError?t.onError(n[e]):jQuery("#geetest-wait").html(n[e]+"，加载验证码失败。")}var l=function(e){return"string"==typeof e},h={},g={};c.Geetest&&(g.slide="loaded");function o(e,o){var i=new t(e);e.https?i.protocol="https://":e.protocol||(i.protocol=c.location.protocol+"//"),n([i.api_server||i.apiserver],i.type_path,i,function(e){function t(){i._extend(e),o(new c.Geetest(i))}var a=e.type;h[a]=h[a]||[];var n=g[a]||"init";"init"===n?(g[a]="loading",h[a].push(t),p(i.protocol,e.static_servers||e.domains,e[a]||e.path,null,function(e){if(e)g[a]="fail",d("networkError",i);else{g[a]="loaded";for(var t=h[a],n=0,o=t.length;n<o;n+=1){var r=t[n];"function"==typeof r&&r()}h[a]=[]}})):"loaded"===n?t():"fail"===n?d("networkError",i):"loading"===n&&h[a].push(t)})}return c.initGeetest=o}),function(){var i,c,e=new FormData;e.append("action","startCaptcha"),(i="/wp-admin/admin-ajax.php",c={data:e,method:"post",responseType:"json"},new Promise(function(t,n){var e=Object.assign({data:null,method:"GET",headers:{},xhr:new XMLHttpRequest,beforeSend:function(){},responseType:""},c),o=e.xhr;for(var r in e.beforeSend(e),e)if(r in o)try{o[r]=e[r]}catch(e){}for(var a in o.open(e.method.toUpperCase(),i),e.headers)o.setRequestHeader(a,e.headers[a]);o.addEventListener("load",function(e){0===o.status||200<=o.status&&o.status<300||304===o.status?t(o):n(Object.assign(Error(o.statusText),{xhr:o,status:o.status}))}),o.addEventListener("error",function(){return n(Object.assign(Error("Network Error"),{xhr:o}))}),o.addEventListener("timeout",function(){return n(Object.assign(Error("Network Timeout"),{xhr:o}))}),o.send(e.data)})).then(function(e){initGeetest({gt:e.response.gt,challenge:e.response.challenge,offline:!e.response.success,new_captcha:e.response.new_captcha,product:"popup",width:"100%"},function(e){e.onReady(function(){e.appendTo("#embed-captcha"),document.getElementById("geetest-wait").style.display="none"})})},function(){document.getElementById("geetest-wait").innerHTML="加载验证码失败。"})}();